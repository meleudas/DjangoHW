{% extends 'main/base.html' %}
{% load shop_filters shop_tags %}

{% block title %}
    {% if search_query %}–ü–æ—à—É–∫: {{ search_query }}{% elif category %}{{ category.name }}{% else %}–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤{% endif %}
{% endblock %}

{% block content %}
<h1>{{ user_greeting }}</h1>

<!-- –ü–æ–ø—É–ª—è—Ä–Ω—ñ —Ç–æ–≤–∞—Ä–∏ (–ø–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∂–¥–∏) -->
{% show_popular_products 3 %}

<!-- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—ñ–≤ -->
<p class="product-count">
    –£—Å—å–æ–≥–æ —Ç–æ–≤–∞—Ä—ñ–≤: <strong>{% get_products_count %}</strong>
    {% if category %}
        | –£ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó "{{ category.name }}": <strong>{% get_products_count category %}</strong>
    {% endif %}
</p>

<!-- üîç –§–æ—Ä–º–∞ –ø–æ—à—É–∫—É -->
{% include 'main/search_form.html' %}

<!-- üîÑ –ö–Ω–æ–ø–∫–∏ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è -->
<div class="sort-buttons">
    <strong>–°–æ—Ä—Ç—É–≤–∞—Ç–∏:</strong>
    <a href="?sort=new{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="sort-btn {% if current_sort == 'new' %}active{% endif %}">–ù–æ–≤—ñ</a>
    <a href="?sort=old{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="sort-btn {% if current_sort == 'old' %}active{% endif %}">–°—Ç–∞—Ä—ñ</a>
    <a href="?sort=popular{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="sort-btn {% if current_sort == 'popular' %}active{% endif %}">–ü–æ–ø—É–ª—è—Ä–Ω—ñ</a>
    <a href="?sort=price_low{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="sort-btn {% if current_sort == 'price_low' %}active{% endif %}">–¶—ñ–Ω–∞: –Ω–∏–∑—å–∫–∞</a>
    <a href="?sort=price_high{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="sort-btn {% if current_sort == 'price_high' %}active{% endif %}">–¶—ñ–Ω–∞: –≤–∏—Å–æ–∫–∞</a>
    <a href="?sort=name{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" class="sort-btn {% if current_sort == 'name' %}active{% endif %}">–ù–∞–∑–≤–∞</a>
</div>

<!-- üì¶ –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä—ñ–≤ -->
<div class="products-grid">
    {% for product in products %}
        {% show_product_card product %}
    {% empty %}
        <p class="no-results">
            {% if search_query %}
                –ó–∞ –∑–∞–ø–∏—Ç–æ–º "<strong>{{ search_query }}</strong>" —Ç–æ–≤–∞—Ä—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.
            {% else %}
                –¢–æ–≤–∞—Ä—ñ–≤ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.
            {% endif %}
        </p>
    {% endfor %}
</div>

<!-- üìÑ –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è -->
{% include 'main/pagination.html' %}
{% endblock %}